# datajson = {
#     "sectors": [
#         {"name": "Agriculture", "description": "Agriculture, with its allied sectors, is unquestionably the largest livelihood provider in India, more so in the vast rural areas. It also contributes a significant figure to the Gross Domestic Product (GDP). "},
#         {"name": "Art & Culture", "description": "Culture plays an important role in the development of any nation. It represents a set of shared attitudes, values, goals and practices. Culture and creativity manifest themselves in almost all economic, social and other activities."},
#         {"name": "Commerce", "description": "Commerce facilitates the domestic environment and infrastructure for promoting internal and international trade in the country."},
#         {"name": "Communications & IT", "description": "Electronic communication and information technology is one of the fastest growing segments of the Indian Industry. Along with the liberalisation in foreign investment and export-import policies, this sector is attracting considerable interest."},
#         {"name": "Defence", "description": "The geographical and topographical diversity, especially the 15,000 km long border which India shares with seven neighbouring countries poses unique challenges to the Indian Defence Forces."},
#         {"name": "Education", "description": "The essence of Human Resource Development is education, which plays a significant and remedial role in balancing the socio-economic framework of the country."},
#         {"name": "Environment & Forest", "description": "Natural resources such as lakes, rivers, forests, wildlife, etc. have a pivotal role in the Indian lifestyle but the growing population of the country is increasing pressure on the environment."},
#         {"name": "Finance & Taxes", "description": "Finance is the backbone of any economy. In order to propel the economic development of the country, finance and tax related matters are highly essential."},
#         {"name": "Food & Public Distribution", "description": "The Department of Food and Public Distribution is responsible for management of the food economy of the nation. It undertakes various activities, such as procurement of food items, their storage, movement and delivery to the distributing agencies."},
#         {"name": "Foreign Affairs", "description": "India’s foreign affairs are closely integrated with the country's fundamental security and developmental priorities."},
#         {"name": "Governance & Administration", "description": "India is a Sovereign, Socialist, Secular, Democratic Republic with a Parliamentary form of government which is federal in structure with unitary features. This section provides data on Indian governance and administration at the Central, state as well as local level."},
#         {"name": "Health & Family Welfare", "description": "Health care should be within the reach of every citizen. For providing basic health facilities to all citizens, the government has introduced and implemented various health schemes and programmes."},
#         {"name": "Home Affairs & Enforcement", "description": "The Ministry of Home Affairs (MHA) ensures internal security through various organisations. It also extends manpower and financial support, guidance and expertise to the State Governments for the maintenance of security, peace and harmony."},
#         {"name": "Housing", "description": "The housing industry of India is one of the fastest growing sectors. A large population base, rising income level and rapid urbanisation leads to growth in this sector."},
#         {"name": "Industries", "description": "Growth in the industrial sector is one of the vital figures that affect the Gross Domestic Product (GDP) in India"},
#         {"name": "Infrastructure", "description": "Infrastructure is a major sector that propels overall development of the Indian economy. This sector includes power, bridges, dams, roads and urban infrastructure development."},
#         {"name": "Information & Broadcasting", "description": "The mass communication media such as radio, television, films, press and print publications, advertising and traditional modes of communication plays an important role in helping people to access free flow of information."},
#         {"name": "Labour & Employment", "description": "Labour policies are devised to maintain economic development, social justice, industrial harmony and welfare of labour in the country."},
#         {"name": "Law & Justice", "description": "The Constitution of India guarantees protection of life and personal liberty to one and all. It provides adequate safeguards to fundamental rights against arbitrary decisions"},
#         {"name": "Power & Energy", "description": "Power and Energy are two essential inputs for economic development and improving the quality of life in India."},
#         {"name": "Rural", "description": "In order to provide the rural people with better prospects for economic development, increased participation of people in the rural development programmes, decentralisation of planning, better enforcement of land reforms and greater access to credit are needed."},
#         {"name": "Science & Technology", "description": "Science and Technology have always been an integral part of Indian culture. Natural philosophy, as it was termed in those ancient times, was pursued vigorously at institutions of higher learning."},
#         {"name": "Social Development", "description": "The Ministry of Social Justice and Empowerment works towards educational development, economic and social empowerment of needy people."},
#         {"name": "Transport", "description": "A well-knit and coordinated system of transport plays an important role in the sustained growth of a country. Transport has recorded an extensive growth over the years both in spread of network and in output of the system."},
#         {"name": "Travel & Tourism", "description": "Travel and tourism is the largest service industry in India. It provides heritage, cultural, medical, business and sports tourism."},
#         {"name": "Youth & Sports", "description": "The population of India majorly comprises youths. Therefore, it is necessary not only to address problems faced by the youths but also provide them opportunities to grow."},
#         {"name": "Water And Sanitation", "description": "Water And Sanitation"},
#     ]
# }


datajson = {
    "sectors": [
        {"name": "Agriculture", "description": "Agriculture, with its allied sectors, is unquestionably the largest livelihood provider in India, more so in the vast rural areas. It also contributes a significant figure to the Gross Domestic Product (GDP). "},
        {"name": "Art And Culture", "description": "Culture plays an important role in the development of any nation. It represents a set of shared attitudes, values, goals and practices. Culture and creativity manifest themselves in almost all economic, social and other activities."},
        {"name": "Commerce", "description": "Commerce facilitates the domestic environment and infrastructure for promoting internal and international trade in the country."},
        {"name": "Information And Communications", "description": "Electronic communication and information technology is one of the fastest growing segments of the Indian Industry. Along with the liberalisation in foreign investment and export-import policies, this sector is attracting considerable interest."},
        {"name": "Defence", "description": "The geographical and topographical diversity, especially the 15,000 km long border which India shares with seven neighbouring countries poses unique challenges to the Indian Defence Forces."},
        {"name": "Education", "description": "The essence of Human Resource Development is education, which plays a significant and remedial role in balancing the socio-economic framework of the country."},
        {"name": "Environment And Forest", "description": "Natural resources such as lakes, rivers, forests, wildlife, etc. have a pivotal role in the Indian lifestyle but the growing population of the country is increasing pressure on the environment."},
        {"name": "Finance", "description": "Finance is the backbone of any economy. In order to propel the economic development of the country, finance and tax related matters are highly essential."},
        {"name": "Food", "description": "The Department of Food and Public Distribution is responsible for management of the food economy of the nation. It undertakes various activities, such as procurement of food items, their storage, movement and delivery to the distributing agencies."},
        {"name": "Foreign Affairs", "description": "India’s foreign affairs are closely integrated with the country's fundamental security and developmental priorities."},
        {"name": "Governance & Administration", "description": "India is a Sovereign, Socialist, Secular, Democratic Republic with a Parliamentary form of government which is federal in structure with unitary features. This section provides data on Indian governance and administration at the Central, state as well as local level."},
        {"name": "Health And Family Welfare", "description": "Health care should be within the reach of every citizen. For providing basic health facilities to all citizens, the government has introduced and implemented various health schemes and programmes."},
        {"name": "Home Affairs And Enforcement", "description": "The Ministry of Home Affairs (MHA) ensures internal security through various organisations. It also extends manpower and financial support, guidance and expertise to the State Governments for the maintenance of security, peace and harmony."},
        {"name": "Housing", "description": "The housing industry of India is one of the fastest growing sectors. A large population base, rising income level and rapid urbanisation leads to growth in this sector."},
        {"name": "Industries", "description": "Growth in the industrial sector is one of the vital figures that affect the Gross Domestic Product (GDP) in India"},
        {"name": "Infrastructure", "description": "Infrastructure is a major sector that propels overall development of the Indian economy. This sector includes power, bridges, dams, roads and urban infrastructure development."},
        {"name": "Information And Broadcasting", "description": "The mass communication media such as radio, television, films, press and print publications, advertising and traditional modes of communication plays an important role in helping people to access free flow of information."},
        {"name": "Labour And Employment", "description": "Labour policies are devised to maintain economic development, social justice, industrial harmony and welfare of labour in the country."},
        {"name": "Judiciary", "description": "The Constitution of India guarantees protection of life and personal liberty to one and all. It provides adequate safeguards to fundamental rights against arbitrary decisions"},
        {"name": "Power And Energy", "description": "Power and Energy are two essential inputs for economic development and improving the quality of life in India."},
        {"name": "Rural", "description": "In order to provide the rural people with better prospects for economic development, increased participation of people in the rural development programmes, decentralisation of planning, better enforcement of land reforms and greater access to credit are needed."},
        {"name": "Science And Technology", "description": "Science and Technology have always been an integral part of Indian culture. Natural philosophy, as it was termed in those ancient times, was pursued vigorously at institutions of higher learning."},
        {"name": "Social Development", "description": "The Ministry of Social Justice and Empowerment works towards educational development, economic and social empowerment of needy people."},
        {"name": "Transport", "description": "A well-knit and coordinated system of transport plays an important role in the sustained growth of a country. Transport has recorded an extensive growth over the years both in spread of network and in output of the system."},
        {"name": "Travel And Tourism", "description": "Travel and tourism is the largest service industry in India. It provides heritage, cultural, medical, business and sports tourism."},
        {"name": "Youth And Sports", "description": "The population of India majorly comprises youths. Therefore, it is necessary not only to address problems faced by the youths but also provide them opportunities to grow."},
        {"name": "Water And Sanitation", "description": "Water And Sanitation"},
        {"name": "Census And Surveys", "description": "Census And Surveys"},
        {"name": "Statistics", "description": "Statistics"},
        {"name": "Water Resources", "description": "Water Resources"},
        {"name": "Economy", "description": "Economy"},
        {"name": "Parliament Of India", "description": "Parliament Of India"},
        {"name": "Urban", "description": "Urban"},
        {"name": "Mining", "description": "Mining"},
        {"name": "Biotechnology", "description": "Biotechnology"},
    ]
}

import requests
import json


# query = f"""
#         mutation {{
#             create_sector(
#             sector_data: {{name:"Finance1", description:"Finance1",official_id:"123"}},
#         ) {{
#             success,
#             errors
#         }}
# }}"""

# headers = {}
# response = requests.post(
#     "https://idpbe.civicdatalab.in/graphql",
#     json={"query": query},
#     headers=headers,
# )

# response_json = json.loads(response.text)
# print(response_json)


for index,each in enumerate(datajson["sectors"]):
    
    try:
        query = f"""
                mutation {{
                    update_sector(
                    sector_data: {{name:"{each["name"]}", description:"{each["description"]}", official_id:"{index}"}},
                ) {{
                    success,
                    errors
                }}
        }}"""

        headers = {}
        response = requests.post(
            "http://localhost:8000/graphql",
            json={"query": query},
            headers=headers,
        )

        response_json = json.loads(response.text)
        print(response_json, index)

    except Exception as update_e:
        print('--------error', update_e)
       
    if  "errors" in response_json:   
        try:
            query = f"""
                    mutation {{
                        create_sector(
                        sector_data: {{name:"{each["name"]}", description:"{each["description"]}", official_id:"{index}"}},
                    ) {{
                        success,
                        errors
                    }}
            }}"""

            headers = {}
            response = requests.post(
                "http://localhost:8000/graphql",
                json={"query": query},
                headers=headers,
            )

            response_json = json.loads(response.text)
            print(response_json)

        except Exception as create_e:
            print('--------error', create_e)




# datajson = {
#     "sectors": [
#         "Health And Family Welfare",
#         "Agriculture",
#         "Census And Surveys",
#         "Water And Sanitation",
#         "Statistics",
#         "Education",
#         "Home Affairs And Enforcement",
#         "Water Resources",
#         "Transport",
#         "Finance",
#         "Governance And Administration",
#         "Animal Husbandry",
#         "Economy",
#         "Environment And Forest",
#         "Power And Energy",
#         "Industries",
#         "Food",
#         "Infrastructure",
#         "Travel And Tourism",
#         "Parliament Of India",
#         "Labour And Employment",
#         "Commerce",
#         "Information And Communications",
#         "Art And Culture",
#         "Rural",
#         "Science And Technology",
#         "Urban",
#         "Youth And Sports",
#         "Social Development",
#         "Mining",
#         "Information And Broadcasting",
#         "Biotechnology",
#         "Defence",
#         "Housing",
#         "Judiciary",
#         "Foreign Affairs",
#     ]
# }